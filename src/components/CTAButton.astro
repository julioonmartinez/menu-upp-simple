---
import type { Restaurant } from '../interfaces';

interface Props {
  restaurant: Restaurant;
  theme?: {
    backgroundColor?: string;
    textColor?: string;
  };
}

const { restaurant, theme } = Astro.props;

const formatWhatsAppUrl = (phone: string, restaurantName: string) => {
  const cleanPhone = phone.replace(/\D/g, '');
  const message = encodeURIComponent(`¡Hola! Me interesa conocer más sobre ${restaurantName}`);
  return `https://wa.me/${cleanPhone}?text=${message}`;
};

const primaryContact = restaurant.phone || restaurant.socialLinks?.whatsapp;
---

{primaryContact && (
  <div class="cta-container">
    <a 
      href={formatWhatsAppUrl(primaryContact, restaurant.name || 'el restaurante')}
      class="cta-button"
      target="_blank"
      rel="noopener noreferrer"
      style={theme ? `--cta-bg: ${theme.backgroundColor}; --cta-text: ${theme.textColor}` : ''}
    >
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>
      </svg>
      Contactar ahora
    </a>
  </div>
)}

<style>
  .cta-container {
    display: flex;
    justify-content: center;
    margin: 2rem 0;
  }
  
  .cta-button {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    padding: 1rem 2rem;
    background-color: var(--cta-bg, #FF4500);
    color: var(--cta-text, #FFFFFF);
    border: none;
    border-radius: 50px;
    font-weight: 600;
    font-size: 1rem;
    text-decoration: none;
    transition: all 0.3s ease;
    box-shadow: 0 4px 15px rgba(255,69,0,0.3);
    position: relative;
    overflow: hidden;
  }
  
  .cta-button::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.2) 50%, transparent 70%);
    transform: translateX(-100%);
    transition: transform 0.6s ease;
  }
  
  .cta-button:hover::before {
    transform: translateX(100%);
  }
  
  .cta-button:hover {
    transform: translateY(-2px) scale(1.02);
    box-shadow: 0 8px 25px rgba(255,69,0,0.4);
  }
  
  .cta-button:active {
    transform: translateY(0) scale(0.98);
  }
  
  @media (max-width: 480px) {
    .cta-button {
      padding: 0.875rem 1.5rem;
      font-size: 0.9rem;
    }
  }
</style>